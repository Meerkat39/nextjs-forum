# Mini Forum
## アプリ概要
ユーザーが投稿を作成し、コメントを付けられる簡易フォーラムシステムです。投稿はタイトルと本文を含み、コメントは本文のみとします。認証機能は設けず、誰でも投稿・コメントができる体験をシミュレーションします。

## 学習目的
* **App Routerの理解**: `app/`ディレクトリ構造と動的ルーティングを体感する
* **Server Actions**: 投稿やコメント作成に `form action` を活用して安全にデータ送信
* **API Routes（`route.ts`）**: 投稿一覧や削除などにfetchを使ってAPIルートを作成・利用
* **Prisma**: 投稿とコメントのリレーション構造を使ったデータ設計
* **Zod**: 入力バリデーションの導入で型安全と実用性の強化
* **TypeScript**: フロント・サーバー双方での型の整合性を学ぶ

## 機能要件
* **投稿一覧**: すべての投稿を一覧表示
* **投稿作成**: 新しい投稿を作成（フォーム）
* **投稿詳細**: 投稿の本文とコメント一覧を表示
* **投稿編集**: 投稿内容を変更する（簡易）
* **投稿削除**: 投稿を削除（削除ボタン）
* **コメント追加**: 各投稿にコメントをつけられる

## 学習ポイント
* App Router 時代のNext.js構造が理解できる
* ServerとClientの役割分担が体感できる
* 「いつ Server Action？いつ route.ts？」という疑問が解消できる
* 小規模ながら、フルスタックな開発の流れを経験できる

## 設計項目
* **データベース設計**:
    * どのようなデータを保存する必要があるか？
    * データ同士はどのような関係にあるか？
* **画面設計**:
    * ユーザーにどのような画面を見せる必要があるか？
    * 各画面にはどのような情報やボタンが必要か？
* **URL設計**:
    * どのURLにアクセスしたら、どの画面が表示されるようにするか？
* **機能とデータの流れの設計**:
    * データはどのように処理されるか？
    * Server ActionsとAPI Routesの使い分け
* **コンポーネント設計**:
    * 画面をどのような部品（コンポーネント）に分割するか？

## 学習手順計画（Todo管理）

### 1. 設計
*   \[x\] **データベース設計**: `Post` と `Comment` のテーブル構成、カラム、リレーションを定義する。
*   \[x\] **画面設計**: 各ページのワイヤーフレーム（画面構成図）を作成し、必要なUI要素を洗い出す。
*   \[x\] **URL設計**: アプリケーションの各ページに対応するURL（ルーティング）を決定する。
*   \[x\] **コンポーネント設計**: 再利用するUI部品（ボタン、フォームなど）を特定し、コンポーネントとして切り出す計画を立てる。

### 2. Next.js & Tailwind CSS セットアップ
*   \[x\] `create-next-app` の実行（完了済み）
*   \[x\] `tailwindcss` をインストールし、設定ファイル (`tailwind.config.ts`, `postcss.config.mjs`) を作成・設定する。

### 3. Prisma セットアップとデータベース定義
*   \[x\] `prisma` をインストールし、`prisma init` を実行する。
*   \[x\] `.env` ファイルにデータベース接続情報（`DATABASE_URL`）を設定する。
*   \[x\] `schema.prisma` に `Post` と `Comment` モデル（テーブル）を定義し、リレーションを設定する。
*   \[x\] `prisma migrate dev` を実行して、データベースにテーブルを作成する。
*   \[x\] `prisma generate` を実行して、Prisma Clientを生成・更新する。

### 4. 投稿一覧ページの作成 (`/posts`)
*   \[ \] `app/posts/page.tsx` ファイルを作成する。
*   \[ \] Prisma Clientを使って、データベースから全ての投稿を取得する非同期関数を実装する。
*   \[ \] 取得した投稿データをReactコンポーネントで一覧表示する。
*   \[ \] 新規投稿ページ (`/posts/new`) へのリンクを設置する。

### 5. 投稿詳細ページの作成 (`/posts/[id]`)
*   \[ \] `app/posts/[id]/page.tsx` という動的ルートを作成する。
*   \[ \] URLの `id` を元に、特定の投稿とそれに関連するコメントをPrisma Clientで取得する。
*   \[ \] 取得した投稿のタイトルと本文を表示する。
*   \[ \] 関連するコメントを一覧表示する。

### 6. 投稿作成機能の実装 (Server Actions)
*   \[ \] `app/posts/new/page.tsx` を作成し、投稿フォーム（タイトル・本文）を設置する。
*   \[ \] フォームの `action` としてServer Actionを定義し、フォームデータをデータベースに保存する処理を実装する。
*   \[ \] 投稿完了後、`revalidatePath` や `redirect` を使って投稿一覧ページを更新・遷移させる。

### 7. コメント機能の実装 (Server Actions)
*   \[ \] 投稿詳細ページ (`/posts/[id]`) にコメント投稿フォームを設置する。
*   \[ \] Server Actionを使い、コメント内容と関連する投稿IDをデータベースに保存する処理を実装する。
*   \[ \] コメント投稿後、`revalidatePath` を使って詳細ページを更新し、新しいコメントを即時表示させる。

### 8. 投稿編集・削除機能の実装
*   \[ \] **編集機能**:
    *   \[ \] `app/posts/[id]/edit/page.tsx` を作成し、編集フォームを設置する。
    *   \[ \] Server Actionで投稿の更新処理を実装する。
*   \[ \] **削除機能**:
    *   \[ \] 投稿詳細ページに削除ボタンを設置する。
    *   \[ \] API Route (`app/api/posts/[id]/route.ts`) を作成し、`DELETE` メソッドで投稿を削除するAPIを実装する。
    *   \[ \] クライアント側から `fetch` を使って削除APIを呼び出す。

### 9. Zodによる入力バリデーション
*   \[ \] `zod` をインストールする。
*   \[ \] 投稿作成・編集フォームの入力値に対するスキーマをZodで定義する。
*   \[ \] Server Action内でスキーマを使い、バリデーション処理を追加する。
*   \[ \] バリデーションエラーが発生した場合、エラーメッセージをフォームに表示する。

### 10. UIスタイリング (Tailwind CSS)
*   \[ \] アプリ全体のレイアウト (`layout.tsx`) に基本的なスタイルを適用する。
*   \[ \] ヘッダーやナビゲーションなどの共通コンポーネントを作成し、スタイルを適用する。
*   \[ \] 投稿一覧、投稿詳細、フォームなどの各ページ・コンポーネントのデザインをTailwind CSSで整える。

## 技術スタック
* **Next.js（App Router）**
* **React + TypeScript**
* **Server Actions**
* **API Routes（`route.ts`）**
* **Prisma（DB）**
* **Zod（バリデーション）**
* **Tailwind CSS（UI スタイリング）**

## 補足事項
リッチな機能（認証・いいね・タグなど）は含めず、CRUD（Create, Read, Update, Delete）とルーティング、Server/Client処理の理解を主目的とします。

## エージェントへの指示
* これは学習目的のプロジェクトです。
* 直接的な答えを提示するのではなく、段階的にヒントを与えながらサポートしてください。
* ファイルの編集は私自身が行いますので、エージェントによるファイル編集は不要です。
* ただし、Tailwind CSSによるスタイリングはエージェントによるファイル編集を許可します。
* **Gitの練習**: 各論理的な手順（`GEMINI.md`の各タスク）が完了するごとにコミットを行い、必要に応じてブランチも活用してください。